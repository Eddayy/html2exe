<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML2EXE - Convert Web Apps to Windows Executables with Wails</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚡</text></svg>">
</head>
<body>
    <div class="container" x-data="html2exeApp()" x-cloak>
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">⚡</span>
                    <span class="logo-text">HTML2EXE</span>
                </div>
                <p class="subtitle">Convert web applications to Windows executables using Wails</p>
            </div>
        </header>

        <main class="main">
            <!-- Upload Section -->
            <section class="upload-section" x-show="currentSection === 'upload'">
                <div class="upload-area" 
                     :class="{ 'dragover': isDragOver }"
                     @dragenter.prevent="isDragOver = true"
                     @dragover.prevent
                     @dragleave.prevent="isDragOver = false"
                     @drop.prevent="handleDrop($event)"
                     @click="$refs.fileInput.click()">
                    <div class="upload-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                    </div>
                    <h3>Upload ZIP File</h3>
                    <p>Drag and drop or <button type="button" class="browse-btn" @click.stop="$refs.fileInput.click()">choose file</button></p>
                    <input type="file" x-ref="fileInput" accept=".zip" @change="handleFileSelect($event)" hidden>
                    <div class="upload-requirements">
                        <div class="requirements-grid">
                            <div class="requirement">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="req-icon">
                                    <polyline points="9,11 12,14 22,4"/>
                                    <path d="m21,6-10,10-4-4"/>
                                </svg>
                                <span>HTML, CSS, JS projects</span>
                            </div>
                            <div class="requirement">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="req-icon">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14,2 14,8 20,8"/>
                                </svg>
                                <span>Maximum 50MB</span>
                            </div>
                            <div class="requirement">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="req-icon">
                                    <rect x="2" y="5" width="20" height="14" rx="2"/>
                                    <line x1="2" y1="10" x2="22" y2="10"/>
                                </svg>
                                <span>Windows compatible</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Configuration Section -->
            <section class="config-section" x-show="currentSection === 'config'">
                <div class="section-header">
                    <h3>Configuration</h3>
                    <p>Customize your application settings</p>
                </div>
                <div class="config-form">
                    <div class="form-group">
                        <label for="appName">Application Name:</label>
                        <input type="text" x-model="config.appName" placeholder="My App" maxlength="214">
                        <small class="field-help">The display name of your application. Special characters will be cleaned for compatibility.</small>
                    </div>
                    <div class="form-group">
                        <label for="appDescription">Description:</label>
                        <input type="text" x-model="config.description" placeholder="A desktop application" maxlength="100">
                        <small class="field-help">Brief description shown in file properties and Task Manager</small>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="appWidth">Window Width:</label>
                            <input type="number" x-model.number="config.width" min="400" max="2000">
                            <small class="field-help">Initial window width in pixels</small>
                        </div>
                        <div class="form-group">
                            <label for="appHeight">Window Height:</label>
                            <input type="number" x-model.number="config.height" min="300" max="1500">
                            <small class="field-help">Initial window height in pixels</small>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="appVersion">Version:</label>
                        <input type="text" x-model="config.version" placeholder="1.0.0" maxlength="20">
                        <small class="field-help">App version number (e.g., 1.0.0, 2.1.3) - shown in file properties</small>
                    </div>
                    <div class="form-group">
                        <label for="appCompany">Company (Optional):</label>
                        <input type="text" x-model="config.company" placeholder="Your Company Name" maxlength="50">
                        <small class="field-help">Company or organization name - appears as publisher</small>
                    </div>
                    
                    <!-- Icon Upload Section -->
                    <div class="form-group icon-upload-group">
                        <label>Application Icon (Optional):</label>
                        <div class="icon-upload-area" @click="$refs.iconInput.click()">
                            <div class="icon-preview" x-show="iconPreviewUrl">
                                <img :src="iconPreviewUrl" alt="Icon preview">
                                <button type="button" class="remove-icon-btn" @click.stop="removeIcon()">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <line x1="18" y1="6" x2="6" y2="18"/>
                                        <line x1="6" y1="6" x2="18" y2="18"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="icon-upload-placeholder" x-show="!iconPreviewUrl">
                                <div class="icon-upload-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                        <circle cx="8.5" cy="8.5" r="1.5"/>
                                        <polyline points="21,15 16,10 5,21"/>
                                    </svg>
                                </div>
                                <p>Upload icon</p>
                                <small>PNG, ICO, JPG • Max 5MB</small>
                            </div>
                            <input type="file" x-ref="iconInput" accept=".png,.ico,.jpg,.jpeg" @change="handleIconSelect($event)" hidden>
                        </div>
                        <small class="field-help">Custom icon for your executable</small>
                    </div>
                </div>
                <div class="action-buttons">
                    <button type="button" class="btn btn-secondary" @click="currentSection = 'upload'">Back</button>
                    <button type="button" class="btn btn-primary" @click="startConversion()" :disabled="!isFormValid">Convert to EXE</button>
                </div>
            </section>

            <!-- Progress Section -->
            <section class="progress-section" x-show="currentSection === 'progress'">
                <div class="section-header">
                    <h3>Converting</h3>
                    <p>Building your Windows executable</p>
                </div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" :style="`width: ${progress.percentage}%`" :class="{ 'loading-animation': progress.animate }"></div>
                    </div>
                    <div class="progress-text" x-text="progress.text">Uploading file...</div>
                </div>
                <div class="progress-steps">
                    <template x-for="(step, index) in progressSteps" :key="index">
                        <div class="step" 
                             :class="{ 
                                'active': progress.step === index + 1, 
                                'completed': progress.step > index + 1 
                             }">
                            <div class="step-number" x-text="index + 1"></div>
                            <div class="step-label" x-text="step"></div>
                        </div>
                    </template>
                </div>
            </section>

            <!-- Result Section -->
            <section class="result-section" x-show="currentSection === 'result'">
                <div class="result-success" x-show="result.success">
                    <div class="success-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                            <polyline points="22,4 12,14.01 9,11.01"/>
                        </svg>
                    </div>
                    <h3>Success</h3>
                    <p>Your executable is ready for download</p>
                    <br/>
                    <div class="download-info">
                        <div class="file-info">
                            <span class="file-name" x-text="result.fileName">app.exe</span>
                            <span class="file-size" x-text="result.fileSize">~50MB</span>
                        </div>
                        <button type="button" class="btn btn-primary btn-download" @click="downloadFile()">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="7,10 12,15 17,10"/>
                                <line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                            Download
                        </button>
                    </div>
                </div>

                <div class="result-error" x-show="result.error">
                    <div class="error-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"/>
                            <line x1="15" y1="9" x2="9" y2="15"/>
                            <line x1="9" y1="9" x2="15" y2="15"/>
                        </svg>
                    </div>
                    <h3>Failed</h3>
                    <p x-text="result.errorMessage">Conversion could not be completed</p>
                    <div class="error-details" x-show="result.errorDetails">
                        <details>
                            <summary>Error Details</summary>
                            <pre x-text="result.errorDetails"></pre>
                        </details>
                    </div>
                </div>

                <div class="action-buttons">
                    <button type="button" class="btn btn-secondary" @click="reset()">Convert Another File</button>
                </div>
            </section>
        </main>

        <footer class="footer">
            <div class="footer-content">
                <div class="footer-links">
                    <a href="https://wails.io" target="_blank">Wails</a>
                    <a href="/api/health" target="_blank">Status</a>
                </div>
                <p class="footer-text">Lightweight Desktop Converter powered by Wails</p>
            </div>
        </footer>
    </div>


    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="script.js"></script>
</body>
</html>